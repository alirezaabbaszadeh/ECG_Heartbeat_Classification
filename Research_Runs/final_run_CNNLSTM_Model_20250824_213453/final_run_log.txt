2025-08-24 21:34:53,701 [INFO    ] root: âœ… GPU memory growth and Mixed Precision enabled. (run_final_evaluation.py:67)
2025-08-24 21:34:53,701 [INFO    ] __main__: === FINAL STAGE: Training & Evaluation for CNNLSTM_Model === (run_final_evaluation.py:146)
2025-08-24 21:34:53,702 [INFO    ] __main__: STEP 1: Locating artifacts from the most recent tuning run... (run_final_evaluation.py:148)
2025-08-24 21:34:53,719 [INFO    ] __main__: Found best hyperparameters, config, and data splits. (run_final_evaluation.py:154)
2025-08-24 21:34:53,727 [INFO    ] __main__: âœ… Loaded optimal hyperparameters: {'embed_dim': 128, 'lstm_units': 128, 'tuner/epochs': 3, 'tuner/initial_epoch': 0, 'tuner/bracket': 2, 'tuner/round': 0} (run_final_evaluation.py:163)
2025-08-24 21:34:53,727 [INFO    ] __main__: STEP 2: Preparing final datasets and building the champion model... (run_final_evaluation.py:169)
2025-08-24 21:34:53,728 [INFO    ] __main__: Using 38 records for final training and 7 for final testing. (run_final_evaluation.py:172)
2025-08-24 21:34:53,728 [INFO    ] __main__: Calculating final normalization statistics in memory-efficient chunks... (run_final_evaluation.py:105)
2025-08-24 21:35:11,189 [INFO    ] __main__: âœ… Final normalization statistics calculated successfully (memory-efficiently). (run_final_evaluation.py:131)
2025-08-24 21:35:11,189 [INFO    ] __main__: Using batch size: 128 (run_final_evaluation.py:180)
2025-08-24 21:35:14,554 [INFO    ] DataLoader: Optimized tf.data.Dataset created using combined shuffling for training. (DataLoader.py:124)
2025-08-24 21:35:14,607 [INFO    ] DataLoader: Optimized tf.data.Dataset created using combined shuffling for validation. (DataLoader.py:124)
2025-08-24 21:35:14,609 [INFO    ] tensorflow: ModelBuilder initialized with SOTA Conformer and enhanced ablation models. (run_final_evaluation.py:188)
2025-08-24 21:35:14,610 [INFO    ] tensorflow: Building a new ABLATION (CNN-LSTM) model instance... (run_final_evaluation.py:198)
2025-08-24 21:35:15,451 [INFO    ] __main__: âœ… Champion model built successfully. (run_final_evaluation.py:199)
2025-08-24 21:35:15,451 [INFO    ] __main__: STEP 3: Training the final model on the entire training dataset... (run_final_evaluation.py:201)
2025-08-24 21:35:15,452 [INFO    ] __main__: Starting final training for 20 epochs. (run_final_evaluation.py:204)
2025-08-24 21:35:15,675 [INFO    ] __main__: Applying class weights for final training: {0: 0.22314518810260608, 1: 6.8006235385814495, 2: 4.104045155221073, 3: 41.64773269689737, 4: 9.62515168229454} (run_final_evaluation.py:211)
2025-08-24 22:26:51,436 [INFO    ] __main__: âœ… Final model training completed. (run_final_evaluation.py:220)
2025-08-24 22:26:51,778 [INFO    ] __main__: ðŸ’¾ Final trained model saved to: Research_Runs/final_run_CNNLSTM_Model_20250824_213453/final_model_CNNLSTM_Model.keras (run_final_evaluation.py:224)
2025-08-24 22:26:51,784 [INFO    ] HistoryManager: ðŸ’¾ Training history saved successfully to: Research_Runs/final_run_CNNLSTM_Model_20250824_213453/final_model_training_history.json (HistoryManager.py:34)
2025-08-24 22:26:51,784 [INFO    ] __main__: STEP 4: Evaluating the final model on the hold-out test set... (run_final_evaluation.py:229)
2025-08-24 22:26:51,941 [INFO    ] Evaluator: Starting evaluation on the test set... (Evaluator.py:59)
2025-08-24 22:26:51,941 [INFO    ] Evaluator: Generating predictions and collecting true labels (122 steps)... (Evaluator.py:66)
2025-08-24 22:26:58,824 [INFO    ] Evaluator: Calculating classification report... (Evaluator.py:86)
2025-08-24 22:26:58,878 [INFO    ] Evaluator: Classification Report:
              precision    recall  f1-score   support

      Normal       0.95      0.15      0.26     12061
        SVEB       0.03      0.41      0.06       214
         VEB       0.90      0.31      0.46      2913
      Fusion       0.00      0.00      0.00       383
     Unknown       0.00      0.00      0.00         2

    accuracy                           0.18     15573
   macro avg       0.38      0.17      0.15     15573
weighted avg       0.91      0.18      0.29     15573
 (Evaluator.py:88)
2025-08-24 22:26:58,879 [INFO    ] Evaluator: Calculating ROC curve and AUC for each class... (Evaluator.py:90)
2025-08-24 22:26:58,938 [INFO    ] Evaluator: AUC for class 'Normal': 0.7307 (Evaluator.py:104)
2025-08-24 22:26:58,941 [INFO    ] Evaluator: AUC for class 'SVEB': 0.7342 (Evaluator.py:104)
2025-08-24 22:26:58,945 [INFO    ] Evaluator: AUC for class 'VEB': 0.8586 (Evaluator.py:104)
2025-08-24 22:26:58,948 [INFO    ] Evaluator: AUC for class 'Fusion': 0.4711 (Evaluator.py:104)
2025-08-24 22:26:58,951 [INFO    ] Evaluator: AUC for class 'Unknown': 0.0278 (Evaluator.py:104)
2025-08-24 22:26:58,955 [INFO    ] Evaluator: Classification report and AUC scores saved to: Research_Runs/final_run_CNNLSTM_Model_20250824_213453/classification_report.txt (Evaluator.py:148)
2025-08-24 22:26:59,981 [INFO    ] Evaluator: Confusion matrix plot saved to: Research_Runs/final_run_CNNLSTM_Model_20250824_213453/confusion_matrix.png (Evaluator.py:160)
2025-08-24 22:27:00,335 [INFO    ] Evaluator: ROC curves plot saved to: Research_Runs/final_run_CNNLSTM_Model_20250824_213453/roc_curves.png (Evaluator.py:178)
2025-08-24 22:27:00,716 [INFO    ] Evaluator: Precision-Recall curves plot saved to: Research_Runs/final_run_CNNLSTM_Model_20250824_213453/precision_recall_curves.png (Evaluator.py:130)
2025-08-24 22:27:00,730 [INFO    ] Evaluator: Raw predictions saved to: Research_Runs/final_run_CNNLSTM_Model_20250824_213453/raw_predictions.npz (Evaluator.py:187)
2025-08-24 22:27:00,730 [INFO    ] __main__: ========================================================== (run_final_evaluation.py:242)
2025-08-24 22:27:00,730 [INFO    ] __main__: === RESEARCH PIPELINE COMPLETED SUCCESSFULLY           === (run_final_evaluation.py:243)
2025-08-24 22:27:00,731 [INFO    ] __main__: All final results are saved in: Research_Runs/final_run_CNNLSTM_Model_20250824_213453 (run_final_evaluation.py:244)
2025-08-24 22:27:00,731 [INFO    ] __main__: ========================================================== (run_final_evaluation.py:245)
