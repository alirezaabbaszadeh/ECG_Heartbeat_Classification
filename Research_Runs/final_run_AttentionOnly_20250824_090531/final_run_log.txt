2025-08-24 09:05:32,381 [INFO    ] root: âœ… GPU memory growth and Mixed Precision enabled. (run_final_evaluation.py:67)
2025-08-24 09:05:32,381 [INFO    ] __main__: === FINAL STAGE: Training & Evaluation for AttentionOnly === (run_final_evaluation.py:146)
2025-08-24 09:05:32,382 [INFO    ] __main__: STEP 1: Locating artifacts from the most recent tuning run... (run_final_evaluation.py:148)
2025-08-24 09:05:32,398 [INFO    ] __main__: Found best hyperparameters, config, and data splits. (run_final_evaluation.py:154)
2025-08-24 09:05:32,412 [INFO    ] __main__: âœ… Loaded optimal hyperparameters: {'embed_dim': 64, 'num_heads': 8, 'ff_dim_multiplier': 4, 'dropout': 0.0, 'num_blocks': 2, 'tuner/epochs': 20, 'tuner/initial_epoch': 7, 'tuner/bracket': 1, 'tuner/round': 1, 'tuner/trial_id': '0018'} (run_final_evaluation.py:163)
2025-08-24 09:05:32,413 [INFO    ] __main__: STEP 2: Preparing final datasets and building the champion model... (run_final_evaluation.py:169)
2025-08-24 09:05:32,414 [INFO    ] __main__: Using 38 records for final training and 7 for final testing. (run_final_evaluation.py:172)
2025-08-24 09:05:32,414 [INFO    ] __main__: Calculating final normalization statistics in memory-efficient chunks... (run_final_evaluation.py:105)
2025-08-24 09:05:50,024 [INFO    ] __main__: âœ… Final normalization statistics calculated successfully (memory-efficiently). (run_final_evaluation.py:131)
2025-08-24 09:05:50,025 [INFO    ] __main__: Using batch size: 128 (run_final_evaluation.py:180)
2025-08-24 09:05:53,833 [INFO    ] DataLoader: Optimized tf.data.Dataset created using combined shuffling for training. (DataLoader.py:124)
2025-08-24 09:05:53,886 [INFO    ] DataLoader: Optimized tf.data.Dataset created using combined shuffling for validation. (DataLoader.py:124)
2025-08-24 09:05:53,887 [INFO    ] tensorflow: ModelBuilder initialized with SOTA Conformer and enhanced ablation models. (run_final_evaluation.py:188)
2025-08-24 09:05:53,887 [INFO    ] tensorflow: Building a new ABLATION (Attention-Only) model instance... (run_final_evaluation.py:198)
2025-08-24 09:05:55,123 [INFO    ] __main__: âœ… Champion model built successfully. (run_final_evaluation.py:199)
2025-08-24 09:05:55,124 [INFO    ] __main__: STEP 3: Training the final model on the entire training dataset... (run_final_evaluation.py:201)
2025-08-24 09:05:55,124 [INFO    ] __main__: Starting final training for 20 epochs. (run_final_evaluation.py:204)
2025-08-24 09:05:55,332 [INFO    ] __main__: Applying class weights for final training: {0: 0.22314518810260608, 1: 6.8006235385814495, 2: 4.104045155221073, 3: 41.64773269689737, 4: 9.62515168229454} (run_final_evaluation.py:211)
2025-08-24 10:02:17,500 [INFO    ] __main__: âœ… Final model training completed. (run_final_evaluation.py:220)
2025-08-24 10:02:17,777 [INFO    ] __main__: ðŸ’¾ Final trained model saved to: Research_Runs/final_run_AttentionOnly_20250824_090531/final_model_AttentionOnly.keras (run_final_evaluation.py:224)
2025-08-24 10:02:17,780 [INFO    ] HistoryManager: ðŸ’¾ Training history saved successfully to: Research_Runs/final_run_AttentionOnly_20250824_090531/final_model_training_history.json (HistoryManager.py:34)
2025-08-24 10:02:17,781 [INFO    ] __main__: STEP 4: Evaluating the final model on the hold-out test set... (run_final_evaluation.py:229)
2025-08-24 10:02:17,933 [INFO    ] Evaluator: Starting evaluation on the test set... (Evaluator.py:59)
2025-08-24 10:02:17,934 [INFO    ] Evaluator: Generating predictions and collecting true labels (122 steps)... (Evaluator.py:66)
2025-08-24 10:02:25,069 [INFO    ] Evaluator: Calculating classification report... (Evaluator.py:86)
2025-08-24 10:02:25,092 [INFO    ] Evaluator: Classification Report:
              precision    recall  f1-score   support

      Normal       0.96      0.27      0.42     12061
        SVEB       0.00      0.00      0.00       214
         VEB       0.28      0.32      0.30      2913
      Fusion       0.01      0.13      0.03       383
     Unknown       0.00      1.00      0.00         2

    accuracy                           0.27     15573
   macro avg       0.25      0.34      0.15     15573
weighted avg       0.80      0.27      0.38     15573
 (Evaluator.py:88)
2025-08-24 10:02:25,093 [INFO    ] Evaluator: Calculating ROC curve and AUC for each class... (Evaluator.py:90)
2025-08-24 10:02:25,121 [INFO    ] Evaluator: AUC for class 'Normal': 0.7650 (Evaluator.py:104)
2025-08-24 10:02:25,126 [INFO    ] Evaluator: AUC for class 'SVEB': 0.7625 (Evaluator.py:104)
2025-08-24 10:02:25,131 [INFO    ] Evaluator: AUC for class 'VEB': 0.6883 (Evaluator.py:104)
2025-08-24 10:02:25,138 [INFO    ] Evaluator: AUC for class 'Fusion': 0.4026 (Evaluator.py:104)
2025-08-24 10:02:25,143 [INFO    ] Evaluator: AUC for class 'Unknown': 0.8049 (Evaluator.py:104)
2025-08-24 10:02:25,147 [INFO    ] Evaluator: Classification report and AUC scores saved to: Research_Runs/final_run_AttentionOnly_20250824_090531/classification_report.txt (Evaluator.py:148)
2025-08-24 10:02:25,926 [INFO    ] Evaluator: Confusion matrix plot saved to: Research_Runs/final_run_AttentionOnly_20250824_090531/confusion_matrix.png (Evaluator.py:160)
2025-08-24 10:02:26,282 [INFO    ] Evaluator: ROC curves plot saved to: Research_Runs/final_run_AttentionOnly_20250824_090531/roc_curves.png (Evaluator.py:178)
2025-08-24 10:02:26,716 [INFO    ] Evaluator: Precision-Recall curves plot saved to: Research_Runs/final_run_AttentionOnly_20250824_090531/precision_recall_curves.png (Evaluator.py:130)
2025-08-24 10:02:26,733 [INFO    ] Evaluator: Raw predictions saved to: Research_Runs/final_run_AttentionOnly_20250824_090531/raw_predictions.npz (Evaluator.py:187)
2025-08-24 10:02:26,733 [INFO    ] __main__: ========================================================== (run_final_evaluation.py:242)
2025-08-24 10:02:26,733 [INFO    ] __main__: === RESEARCH PIPELINE COMPLETED SUCCESSFULLY           === (run_final_evaluation.py:243)
2025-08-24 10:02:26,734 [INFO    ] __main__: All final results are saved in: Research_Runs/final_run_AttentionOnly_20250824_090531 (run_final_evaluation.py:244)
2025-08-24 10:02:26,734 [INFO    ] __main__: ========================================================== (run_final_evaluation.py:245)
